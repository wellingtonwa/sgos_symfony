CREATE TABLE cidade (id BIGINT AUTO_INCREMENT, nome VARCHAR(255) NOT NULL UNIQUE, idestado BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idestado_idx (idestado), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE cliente (id BIGINT AUTO_INCREMENT, nome VARCHAR(255) NOT NULL, logradouro VARCHAR(255), numero VARCHAR(255), complemento VARCHAR(255), bairro VARCHAR(255), idcidade BIGINT, telefoneresidencial VARCHAR(20), telefonecomercial VARCHAR(20), email VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idcidade_idx (idcidade), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE componente (id BIGINT AUTO_INCREMENT, nome VARCHAR(255) NOT NULL UNIQUE, descricao TEXT NOT NULL, preco DECIMAL(18, 2), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE componente_ordem_servico (id BIGINT AUTO_INCREMENT, idordemservico BIGINT NOT NULL, idcomponente BIGINT NOT NULL, quantidade BIGINT, INDEX idordemservico_idx (idordemservico), INDEX idcomponente_idx (idcomponente), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE equipamento (id BIGINT AUTO_INCREMENT, nome VARCHAR(255) NOT NULL, descricao TEXT, idtipoequipamento BIGINT, idcliente BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idcliente_idx (idcliente), INDEX idtipoequipamento_idx (idtipoequipamento), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE estado (id BIGINT AUTO_INCREMENT, nome VARCHAR(255) NOT NULL UNIQUE, sigla VARCHAR(4) NOT NULL, idpais BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idpais_idx (idpais), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE ordem_servico (id BIGINT AUTO_INCREMENT, idcliente BIGINT, idequipamento BIGINT, status VARCHAR(255) DEFAULT 'Em Aberto', descricao_problema TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idcliente_idx (idcliente), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE ordem_servico_equipamento (id BIGINT AUTO_INCREMENT, idequipamento BIGINT NOT NULL, idordemservico BIGINT NOT NULL, INDEX idordemservico_idx (idordemservico), INDEX idequipamento_idx (idequipamento), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE pais (id BIGINT AUTO_INCREMENT, nome VARCHAR(255) NOT NULL UNIQUE, sigla VARCHAR(255) NOT NULL UNIQUE, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE preco_componente (id BIGINT AUTO_INCREMENT, preco DECIMAL(18, 2), datainicio DATETIME, idcomponente BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idcomponente_idx (idcomponente), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE preco_servico (id BIGINT AUTO_INCREMENT, preco DECIMAL(18, 2), datainicio DATETIME, idservico BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idservico_idx (idservico), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE servico (id BIGINT AUTO_INCREMENT, nome VARCHAR(255) NOT NULL UNIQUE, descricao TEXT NOT NULL, preco DECIMAL(18, 2), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE servico_ordem_servico (id BIGINT AUTO_INCREMENT, idordemservico BIGINT NOT NULL, idservico BIGINT NOT NULL, quantidade BIGINT, INDEX idordemservico_idx (idordemservico), INDEX idservico_idx (idservico), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE status (id BIGINT AUTO_INCREMENT, nome VARCHAR(50) NOT NULL, significado TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE tipo_equipamento (id BIGINT AUTO_INCREMENT, nome VARCHAR(255) NOT NULL UNIQUE, descricao TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_forgot_password (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, unique_key VARCHAR(255), expires_at DATETIME NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id BIGINT AUTO_INCREMENT, user_id BIGINT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user (id BIGINT AUTO_INCREMENT, first_name VARCHAR(255), last_name VARCHAR(255), email_address VARCHAR(255) NOT NULL UNIQUE, username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id BIGINT, group_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) ENGINE = INNODB;
ALTER TABLE cidade ADD CONSTRAINT cidade_idestado_estado_id FOREIGN KEY (idestado) REFERENCES estado(id);
ALTER TABLE cliente ADD CONSTRAINT cliente_idcidade_cidade_id FOREIGN KEY (idcidade) REFERENCES cidade(id);
ALTER TABLE componente_ordem_servico ADD CONSTRAINT componente_ordem_servico_idordemservico_ordem_servico_id FOREIGN KEY (idordemservico) REFERENCES ordem_servico(id);
ALTER TABLE componente_ordem_servico ADD CONSTRAINT componente_ordem_servico_idcomponente_componente_id FOREIGN KEY (idcomponente) REFERENCES componente(id);
ALTER TABLE equipamento ADD CONSTRAINT equipamento_idtipoequipamento_tipo_equipamento_id FOREIGN KEY (idtipoequipamento) REFERENCES tipo_equipamento(id);
ALTER TABLE equipamento ADD CONSTRAINT equipamento_idcliente_cliente_id FOREIGN KEY (idcliente) REFERENCES cliente(id);
ALTER TABLE estado ADD CONSTRAINT estado_idpais_pais_id FOREIGN KEY (idpais) REFERENCES pais(id);
ALTER TABLE ordem_servico ADD CONSTRAINT ordem_servico_idcliente_cliente_id FOREIGN KEY (idcliente) REFERENCES cliente(id);
ALTER TABLE ordem_servico_equipamento ADD CONSTRAINT ordem_servico_equipamento_idordemservico_ordem_servico_id FOREIGN KEY (idordemservico) REFERENCES ordem_servico(id) ON DELETE CASCADE;
ALTER TABLE ordem_servico_equipamento ADD CONSTRAINT ordem_servico_equipamento_idequipamento_equipamento_id FOREIGN KEY (idequipamento) REFERENCES equipamento(id) ON DELETE CASCADE;
ALTER TABLE preco_componente ADD CONSTRAINT preco_componente_idcomponente_componente_id FOREIGN KEY (idcomponente) REFERENCES componente(id);
ALTER TABLE preco_servico ADD CONSTRAINT preco_servico_idservico_servico_id FOREIGN KEY (idservico) REFERENCES servico(id);
ALTER TABLE servico_ordem_servico ADD CONSTRAINT servico_ordem_servico_idservico_servico_id FOREIGN KEY (idservico) REFERENCES servico(id);
ALTER TABLE servico_ordem_servico ADD CONSTRAINT servico_ordem_servico_idordemservico_ordem_servico_id FOREIGN KEY (idordemservico) REFERENCES ordem_servico(id);
ALTER TABLE sf_guard_forgot_password ADD CONSTRAINT sf_guard_forgot_password_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
